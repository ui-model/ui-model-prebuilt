# 放大镜

放大镜的本质就是**坐标映射**。

也就是说，这个交互逻辑的本质在于：缩略图上的一个方框，当它映射到原图上之后，其四角坐标应该是什么？

因此，我们只需要抽取出这样一个逻辑：有一个缩略图（主动区），一个原图（被动区），两者都各自有一个镜头，这两个镜头的大小比例就是缩略图和原图之间的大小比例，并且它们的位置也符合这个比例。（另外，原图镜头本身不需要指定大小，它会根据缩略图大小、原图大小和缩略镜头大小来自动计算。）

于是，当我们移动缩略镜头的时候，原图镜头也跟着变化，用户最终看到的部分就是原图镜头所截取的部分。

上面是简化过的思维模型。而在实际应用中我们需要保持原图镜头的位置不动，而是移动原图，因此我们只需要把坐标取反之后移动原图就行了。

除此之外，在具体实现中，我们还需要获取这些大小。我们可以用**辅助指令**来实现。辅助指令不是专用于某个ui-model的，甚至不必配合ui-model也能使用，它是ui-model和DOM之间的桥梁，每一个都相当精简。

至于取这些坐标，我们只要使用内置的(mousemove)事件就可以了，不必做特别处理。


# 提示

## 如何设置鼠标未进入时隐藏镜头和原图？
1. 在缩略图所在的元素上添加`(mouseenter)`和`(mouseleave)`来设置变量标识鼠标状态,例如：
    `(mouseenter)="isMouseInPicture = true" (mouseleave)="isMouseInPicture = false"`
1. 在镜头和原图元素上添加`[ngStyle]="{'visibility': !isMouseInPicture?'hidden':''}"`，在鼠标没有进入图片的时候隐藏。
注意，隐藏元素有两种，这里只能用`visibility:hidden`，不能用`display:none`。因为后者对布局无影响，而`zoom`初始化时依赖元素在布局中的大小。

## 如何将原图剥离出来放到缩略图的右边？

用CSS可以轻松实现：

1. 将`.passive-rect`的`position`改为`absoulte`，确认`.active-rect`的`position`为`relative`，这样原图的位置就只以缩略图为准
1. 调整原图位置，这样修改`.passive-rect`：
1. 添加`z-index:100`，确保原图在其他元素的上面
1. 设置原图的置顶位置：`top:0`
1. 将原图靠左位置设置为缩略图的宽度，如果你的缩略图是固定宽度，比如340px，那么可以添加: `left: 340px`。你也可以动态将`left`设置为缩略图的宽度：在`.passive-rect`所在的元素上添加：`[style.left.px]="zoom.activeRect.width + 10"`